!function(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===i&&r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}("table {\n  font-size: 10pt;\n}\n\n.header-wrapper {\n  position: fixed;\n  overflow: hidden;\n  visibility: hidden;\n  z-index: 2;\n}\n\n.column-wrapper {\n  position: fixed;\n  overflow: hidden;\n  visibility: hidden;\n  z-index: 1;\n}\n\n.column-header-wrapper {\n  position: fixed;\n  overflow: hidden;\n  visibility: hidden;\n  z-index: 3;\n}\n\n.scroll-bar-wrapper {\n  position: fixed;\n  overflow-x: scroll;\n  visibility: hidden;\n  bottom: 0;\n  z-index: 2;\n}\n");const e=e=>{const t=window.getComputedStyle(e),i=parseFloat(t.marginTop),r=parseFloat(t.marginBottom);return e.offsetHeight+i+r},t={fixedNavbar:"string",freezeHead:"boolean",freezeColumn:"boolean",freezeColumnHead:"boolean",scrollBar:"boolean",scrollable:"boolean",columnBorderWidth:"number",columnNum:"number",columnKeep:"boolean",shadow:"boolean",headWrapStyles:"object",columnWrapStyles:"object",columnHeadWrapStyles:"object",backgroundColor:"string"};class i{static initializedTables={};defaultOptions={fixedNavbar:"",freezeHead:!0,freezeColumn:!0,freezeColumnHead:!0,scrollBar:!1,scrollable:!1,columnBorderWidth:1,columnNum:1,columnKeep:!1,shadow:!1,headWrapStyles:{},columnWrapStyles:{},columnHeadWrapStyles:{},backgroundColor:"white"};container=window;headWrapper=document.createElement("div");columnWrapper=document.createElement("div");columnHeadWrapper=document.createElement("div");scrollBarWrapper=document.createElement("div");tableWrapperReadOnlyStyles={};constructor(e,t){if(this.tableWrapper=document.querySelector(`#${e}`),[this.table]=this.tableWrapper.children,this.fixedNavbarHeight=0,this.scrollBarHeight=window.innerWidth-document.documentElement.clientWidth,this.options=Object.assign(this.defaultOptions,t),this.validate(),!this.options.scrollable){const e=window.getComputedStyle(this.tableWrapper);this.tableWrapperReadOnlyStyles.height=e.height,this.tableWrapperReadOnlyStyles.minHeight=e.minHeight,this.tableWrapperReadOnlyStyles.maxHeight=e.maxHeight,this.tableWrapper.style.height="100%",this.tableWrapper.style.minHeight="100%",this.tableWrapper.style.maxHeight="100%"}this.buildContainer(),this.buildOptions(),this.initEvents(),i.initializedTables[this.table.id]=!0}validate(){if(!this.table)throw new Error("Table element not found. Please provide a valid table ID.");if(i.initializedTables[this.tableWrapper.id])throw new Error(`Table already initialized. ID: ${this.tableWrapper.id} Cannot initialize the same table multiple times.`);if("table"!==this.table.nodeName.toLowerCase())throw new Error(`Element with ID ${this.table.id} is not a table element.`);if(!this.hasTbodyAndThead())throw new Error("Table must have both tbody and thead elements.");if(this.validateOptionsObject())throw new Error("Wrong key name or type. Please provide a valid key for the options object.");if(this.options.fixedNavbar&&!document.querySelector(`#${this.options.fixedNavbar}`))throw new Error("Fixed Navbar not found. Please provide a valid ID.")}hasTbodyAndThead(){let e=!1,t=!1;for(let i=0;i<this.table.childNodes.length;i+=1){const r=this.table.childNodes[i];"tbody"===r.nodeName.toLowerCase()&&(e=!0),"thead"===r.nodeName.toLowerCase()&&(t=!0)}return e&&t}validateOptionsObject(){return Object.entries(this.options).some((([e,i])=>typeof i!==t[e]))}buildOptions(){Object.keys(this.options).forEach((e=>{if(this.options[e]){const i=`build${(t=e).charAt(0).toUpperCase()+t.slice(1)}`;"function"==typeof this[i]&&this[i]()}var t}))}buildFreezeHead(){const e=this.table.cloneNode(!0);if(e.style.margin=0,this.headWrapper.classList.add("header-wrapper"),this.headWrapper.append(e),this.headWrapper.style.top=`${this.fixedNavbarHeight}px`,e.style.backgroundColor=this.options.backgroundColor,this.options.shadow&&(this.headWrapper.style.boxShadow="0px 6px 10px -5px rgba(159, 159, 160, 0.8)"),Object.keys(this.options.headWrapStyles).length&&Object.entries(this.options.headWrapStyles).forEach((([e,t])=>{this.headWrapper.style[e]=t})),this.tableWrapper.append(this.headWrapper),this.tableWrapper.addEventListener("scroll",(()=>{this.headWrapper.scrollLeft=this.tableWrapper.scrollLeft})),this.options.scrollable){const e=()=>{const{top:e}=this.tableWrapper.getBoundingClientRect();this.tableWrapper.scrollTop>0&&e>this.fixedNavbarHeight?(this.headWrapper.style.top=`${e}px`,this.headWrapper.style.visibility="visible"):this.headWrapper.style.visibility="hidden"};this.tableWrapper.addEventListener("scroll",e),this.container.addEventListener("scroll",e)}else this.container===window&&this.container.addEventListener("scroll",(()=>{const e=this.container.scrollY+this.fixedNavbarHeight,t=this.table.offsetTop-1;t-1<=e&&t+this.table.offsetHeight-1>=e?this.headWrapper.style.visibility="visible":this.headWrapper.style.visibility="hidden"}));const t=()=>{const e=this.options.scrollable?this.tableWrapper.offsetWidth-this.scrollBarHeight:this.tableWrapper.offsetWidth,t=e>0?e:this.tableWrapper.offsetWidth;this.headWrapper.style.width=`${t}px`,this.headWrapper.style.height=`${this.table.querySelector("thead").offsetHeight}px`};this.container.addEventListener("resize",t);new ResizeObserver(t).observe(this.tableWrapper)}buildFreezeColumn(){const e=this.table.cloneNode(!0);this.columnWrapper.classList.add("column-wrapper"),this.columnWrapper.append(e),e.style.backgroundColor=this.options.backgroundColor;const t=this.options.shadow?0:1,i=this.options.columnBorderWidth||t;this.options.shadow&&(this.columnWrapper.style.boxShadow="6px 0px 10px -5px rgba(159, 159, 160, 0.8)"),Object.keys(this.options.columnWrapStyles).length&&Object.entries(this.options.columnWrapStyles).forEach((([e,t])=>{this.columnWrapper.style[e]=t})),this.tableWrapper.append(this.columnWrapper);const r=window.getComputedStyle(this.tableWrapper);this.tableWrapperReadOnlyStyles.overflowX=r.overflowX,this.tableWrapper.style.overflowX="scroll";const s=()=>{this.columnWrapper.style.top=`${this.tableWrapper.getBoundingClientRect().top}px`};if(this.options.scrollable){let e=this.tableWrapper.clientHeight-this.scrollBarHeight;e=e>0?e:this.tableWrapper.clientHeight,this.columnWrapper.style.height=`${e}px`}if(this.options.columnKeep&&(this.columnWrapper.style.visibility="visible"),!this.options.columnKeep&&this.options.scrollable){const e=()=>{this.tableWrapper.scrollLeft>0?(this.columnWrapper.scrollTop=this.tableWrapper.scrollTop,this.columnWrapper.style.visibility="visible"):this.columnWrapper.style.visibility="hidden"};this.tableWrapper.addEventListener("scroll",e)}this.options.columnKeep||this.options.scrollable||this.tableWrapper.addEventListener("scroll",(()=>{this.isWindowScrollX||(this.tableWrapper.scrollLeft>0?this.columnWrapper.style.visibility="visible":this.columnWrapper.style.visibility="hidden")})),this.container.addEventListener("resize",(()=>{e.style.width=`${this.table.clientWidth}px`;let t=0+i;for(let e=1;e<=this.options.columnNum;e+=1){t+=this.table.querySelector(`th:nth-child(${e})`).offsetWidth}this.columnWrapper.style.width=`${t}px`,s()})),this.container.addEventListener("scroll",s)}buildFreezeColumnHead(){let t;this.options.freezeHead||this.buildFreezeHead(),this.options.freezeColumn||this.buildFreezeColumn(),this.columnHeadWrapper=this.headWrapper.cloneNode(!0),this.columnHeadWrapper.classList.add("column-header-wrapper"),this.tableWrapper.append(this.columnHeadWrapper),this.options.shadow&&(this.columnHeadWrapper.style.boxShadow="none"),Object.keys(this.options.columnHeadWrapStyles).length&&Object.entries(this.options.columnHeadWrapStyles).forEach((([e,t])=>{this.columnHeadWrapper.style[e]=t})),this.options.scrollable?(t=()=>{const{top:e}=this.tableWrapper.getBoundingClientRect();this.tableWrapper.scrollTop>0&&e>this.fixedNavbarHeight?(this.columnHeadWrapper.style.top=`${e}px`,this.columnHeadWrapper.style.visibility="visible"):this.columnHeadWrapper.style.visibility="hidden"},this.tableWrapper.addEventListener("scroll",t)):this.container===window&&(t=()=>{const t=this.container.scrollY+this.fixedNavbarHeight,i=this.table.offsetTop-1,r=e(this.table);i-1<=t&&i+r-1>=t&&this.tableWrapper.scrollLeft>0?this.columnHeadWrapper.style.visibility="visible":this.columnHeadWrapper.style.visibility="hidden"}),this.container.addEventListener("scroll",t),this.tableWrapper.addEventListener("scroll",(()=>{this.isWindowScrollX||t()})),this.container.addEventListener("resize",(()=>{const t=this.columnHeadWrapper.querySelector("table"),i=window.getComputedStyle(this.table),r=window.getComputedStyle(this.columnWrapper),s=this.table.querySelector("thead"),l=e(s);t.style.width=i.width,this.columnHeadWrapper.style.width=r.width,this.columnHeadWrapper.style.height=`${l}px`}))}buildScrollBar(){const t=window.getComputedStyle(this.table),i=window.getComputedStyle(this.tableWrapper),r=document.createElement("div");r.style.width=t.width,r.style.height="1px",this.scrollBarWrapper.classList.add("scroll-bar-wrapper"),this.scrollBarWrapper.style.width=i.width,this.scrollBarWrapper.style.height=this.scrollBarHeight,this.scrollBarWrapper.append(r),this.tableWrapper.append(this.scrollBarWrapper),this.scrollBarWrapper.addEventListener("scroll",(()=>{this.tableWrapper.scrollLeft=this.scrollBarWrapper.scrollLeft})),this.tableWrapper.addEventListener("scroll",(()=>{this.scrollBarWrapper.scrollLeft=this.tableWrapper.scrollLeft})),this.container.addEventListener("scroll",(()=>{const t=e(this.table.querySelector("thead")),i=(window.screenY||document.documentElement.scrollTop)+window.innerHeight-t+this.fixedNavbarHeight,r=this.table.getBoundingClientRect().top,s=e(this.table);this.scrollBarWrapper.style.visibility=r-1<=i&&r+s-1>=i?"visible":"hidden"})),this.container.addEventListener("resize",(()=>{r.width=t.width,this.scrollBarWrapper.width=i.width}))}buildFixedNavbar(){if(this.options.fixedNavbar){const e=document.querySelector(`#${this.options.fixedNavbar}`);this.fixedNavbarHeight=e.offsetHeight}}buildContainer(){const e=()=>{this.container.scrollLeft>0?(this.isWindowScrollX=!0,this.headTableWrap&&(this.headTableWrap.style.visibility="hidden"),this.columnTableWrap&&(this.columnTableWrap.style.visibility="hidden"),this.columnHeadTableWrap&&(this.columnHeadTableWrap.style.visibility="hidden"),this.scrollBarWrap&&(this.scrollBarWrap.style.visibility="hidden")):this.isWindowScrollX=!1};this.container.addEventListener("scroll",(()=>{e()}))}initEvents(){const e=new Event("resize"),t=new Event("scroll");this.container.dispatchEvent(e),this.container.dispatchEvent(t),this.tableWrapper.dispatchEvent(t)}destroy(){const e=()=>{};this.options.scrollable||(this.tableWrapper.style.height=this.tableWrapperReadOnlyStyles.height,this.tableWrapper.style.minHeight=this.tableWrapperReadOnlyStyles.minHeight,this.tableWrapper.style.maxHeight=this.tableWrapperReadOnlyStyles.maxHeight),this.options.freezeHead&&(this.headWrapper.remove(),this.tableWrapper.removeEventListener("scroll",e),this.container.removeEventListener("scroll",e),this.container.removeEventListener("resize",e)),this.options.freezeColumn&&(this.columnWrapper.remove(),this.tableWrapper.style.overflowX=this.tableWrapperReadOnlyStyles.overflowX,this.tableWrapper.removeEventListener("scroll",e),this.container.removeEventListener("scroll",e),this.container.removeEventListener("resize",e)),this.options.freezeColumnHead&&(this.columnHeadWrapper.remove(),this.tableWrapper.removeEventListener("scroll",e),this.container.removeEventListener("scroll",e),this.container.removeEventListener("resize",e)),this.options.scrollBar&&(this.scrollBarWrapper.remove(),this.tableWrapper.removeEventListener("scroll",e),this.container.removeEventListener("scroll",e),this.container.removeEventListener("resize",e)),this.options.container&&this.container.removeEventListener("scroll",e)}}const r=(e,t)=>{new i(e,t)};export{i as FreezeTable,r as freezeTableCall};
